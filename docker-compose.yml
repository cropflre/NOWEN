version: '3.8'

services:
  nowen:
    build: .
    container_name: nowen
    restart: unless-stopped
    ports:
      - "3002:3000"
    volumes:
      - ./server/data:/app/server/data
      # æŒ‚è½½å®¿ä¸»æœºæ ¹ç›®å½•ï¼ˆåªè¯»ï¼‰ï¼Œè®© systeminformation è¯»å–çœŸå®ç³»ç»ŸçŠ¶æ€
      - /:/host:ro
      # æŒ‚è½½ proc æ–‡ä»¶ç³»ç»Ÿï¼Œç”¨äºè¯»å– CPUã€å†…å­˜ç­‰ä¿¡æ¯
      - /proc:/host/proc:ro
      # æŒ‚è½½ sys æ–‡ä»¶ç³»ç»Ÿï¼Œç”¨äºè¯»å–æ¸©åº¦ã€ç¡¬ä»¶ä¿¡æ¯
      - /sys:/host/sys:ro
      # ğŸ”‘ å…³é”®ï¼šæŒ‚è½½ Docker socketï¼Œå…è®¸è¯»å–å®¿ä¸»æœº Docker å®¹å™¨çŠ¶æ€
      - /var/run/docker.sock:/var/run/docker.sock
    environment:
      - NODE_ENV=production
      # å‘Šè¯‰ systeminformation ä» /host è·¯å¾„è¯»å–æ–‡ä»¶ç³»ç»Ÿä¿¡æ¯
      - SI_FILESYSTEM_DISK_PREFIX=/host
      # è®¾ç½® proc è·¯å¾„
      - PROC_PATH=/host/proc
      # è®¾ç½® sys è·¯å¾„  
      - SYS_PATH=/host/sys
      # æ–‡ä»¶ç³»ç»Ÿæ ¹è·¯å¾„
      - FS_PATH=/host
    # ğŸ”‘ ç‰¹æƒæ¨¡å¼ï¼šå…è®¸è¯»å– CPU æ¸©åº¦ã€SMART ç£ç›˜ä¿¡æ¯ã€å®Œæ•´ç¡¬ä»¶ä¿¡æ¯
    privileged: true


